---
title: "Analysis of ME/CFS Patient Clusters in Vaes Data Reveals Distinct Subgroups"
author: "Erik Squires"
date: "September 13, 2025"
bibliography: references.bib
csl: nature.csl
citeproc: true
colorlinks: true
geometry: margin=1in
toc: false
toc-title: "Contents"
toc-depth: 2
secnumdepth: 2
number-sections: true
format:
  pdf:
    include-in-header:
      text: |
        \raggedright
        \usepackage{tocloft}
        \usepackage{float}
        \usepackage{placeins}
        \usepackage{needspace}
        \setlength\LTpre{0pt}
        \setlength\LTpost{0pt}
    keep-tex: true
    pdf-engine: lualatex
lof: false   # list of figures
lot: false   # list of tables
execute:
  echo: false
  warning: false
  message: false
---

```{r setup, include=FALSE}
library(tidyverse)
library(gt)
library(patchwork)
library(gtools)
library(showtext); showtext_auto()

input_file <- here::here("data", "cluster_grouped_tidy.csv")

if (!file.exists(input_file)) {
  stop(paste("Input file", input_file, "not found. Please run summarize_vaes_csv_by_symptom_domain.R first."))
}

vcs_tidy <- read_csv(input_file) %>%
  mutate(intensity_group = as.factor(str_trim(intensity_group))) %>%
  droplevels()

cluster_sizes <-  read_csv(here::here("data", "vaes_cluster_sizes.csv"))

group_sizes <- vcs_tidy %>%
  left_join(cluster_sizes, by = "cluster") %>%
  group_by(intensity_group) %>%
  summarize(total_size = sum(size), .groups = 'drop')

# Calculate the ratio of the high and low intensity groups
high_size <- group_sizes %>% filter(intensity_group == "high") %>% pull(total_size)
low_size <- group_sizes %>% filter(intensity_group == "low") %>% pull(total_size)
size_ratio <- high_size / low_size
low_pct <- round((low_size / (high_size + low_size)) * 100, 1)
high_pct <- 100 - low_pct

geo_plot_vs_pem <- function(yvar, ylabel) {
  # Not strictly needed, but makes reading and debugging nicer
  columns = c("cluster", "PEM", yvar, "intensity_group")
  df <- vcs_tidy %>% select(all_of(columns))
  
  ggplot(df, aes(x = PEM, y = !!sym(yvar))) +
    geom_point(aes(color = intensity_group, shape = intensity_group), size = 3) +
    ggrepel::geom_text_repel(aes(label = cluster), size = 3, show.legend = FALSE) +
#   scale_shape_manual(values = c("high" = 16, "low" = 17, "out" = 4)) +
    scale_shape_manual(values = c("high" = 16, "low" = 17)) +
    scale_color_brewer(name = "Subgroup", type="qual", palette = "Set1",
                       labels = c("high" = "High", "low" = "Low")) +
    guides(color = guide_legend(override.aes = list(shape = c(16, 17))),
           shape = "none") +
    geom_smooth(aes(color = intensity_group, group = intensity_group), method = "lm", se = TRUE) +
    labs(title = paste(ylabel, "vs PEM"),
         x = "PEM",
         y = ylabel) +
    theme_minimal(base_family = "sans") +  # Or switch to theme_minimal()
    xlim(0, 4.0) + ylim(0, 4.0)
}

```

Affiliation: Independent Researcher

ORCID: 0009-0000-3843-4953

Email: esquires.research\@proton.me

# Abstract {.unnumbered}

**Background:** Vaes et al. (2023)[@vaes2023] identified 13 symptom clusters in a large cohort of ME/CFS patients. Symptom intensity is broadly correlated with post-exertional malaise (PEM) severity, with variation across clusters that seems heterogeneous. Despite this research, no broadly accepted organizing principle has emerged from this paper or other attempts at phenotyping ME/CFS.

**Objective:** To identify and characterize potential subgroups defined by symptom domain severity relative to PEM within the original Vaes symptom clusters.

**Methods:** We analyzed the Vaes cluster summary data [@vaes2023_excel], calculated geometric means for each symptom domain within each cluster, and plotted these means against PEM severity to identify patterns and subgroups.

**Results:** We identified two groups of patient clusters with distinct symptom-domain profiles. Separating the 13 clusters into these subgroups reduced heterogeneity within each. The first group showed a consistent amplification pattern across all symptom domains as PEM increased, whereas the second group exhibited selective amplification: pain and neurocognitive symptoms escalated more rapidly with PEM, while immune and sleep symptoms remained relatively flat. This subgroup's profile resembles that of fibromyalgia.

**Keywords:** Myalgic Encephalomyelitis, ME/CFS, patient clustering, fibromyalgia, post-exertional malaise, PEM

{{< pagebreak >}}

\tableofcontents

{{< pagebreak >}}

\listoffigures
\listoftables

{{< pagebreak >}}

# Introduction

Dr. Anouk W. Vaes and her collaborators at CIRO performed one of the largest systematic surveys of ME/CFS symptom patterns, applying clustering methods to patient-reported outcomes to identify recurring constellations of symptoms [@vaes2023]. They used symptom surveys based on the DePaul Symptom Questionnaire version 2 (DSQ-2) from 337 patients to identify a total of 45 patient clusters of which 13 were of size $\geq$ 10. We used the publicly available data of their final 13 clusters for analysis.[@vaes2023_excel]

While Vaes described each cluster, and noted some differences among symptom severity, an overall organizing principle was not proposed. Other methods have been used to group ME/CFS phenotypes, including by severity alone, or a combination of severity and symptoms but no consensus has emerged on how to best group patients.

Our analysis suggests that the Vaes ME/CFS clusters can be organized into two overarching families defined by their relationship to PEM. This reduces the complexity of the cluster symptom intensities and highlights a fibromyalgia-like subgroup within the Vaes clusters that has not been explicitly recognized in prior work.

According to Vaes[@vaes2023]:

> Almost 90% of the participants fulfilled the Fukuda case definition, compared to 80%, 59% and 39% fulfilling the IOM, CCC and ME-ICC case definitions, respectively. More than a quarter of the participants met the criteria for all four different case definitions, whilst 5% of the participants met none of the abovementioned \[sp.\] case definitions,...

This means the patients in the Vaes study were diagnosed with broad and different criteria which, when taken together with our analysis, provides one of the first opportunities to quantitatively separate classic ME/CFS and fibromyalgia-like patients from a single, uniformly collected cohort.

# Visual Analysis of Symptom Domains vs. PEM

The strong weight of PEM symptoms makes the Vaes dataset tricky to interpret if you only look at raw intensity, so instead we compared overall symptom levels to PEM severity. From this comparison we identified two groups of clusters that maintain their integrity across most symptom domains.

We will start by showing how the groups are most similar, then how they differ. We add an "all" category to gauge overall symptom severity to the original symptom domains. Our use of the terms “high” and “low intensity” does not reproduce the clusters described by Vaes or others but reflects a new organization based on how symptom domains scale with PEM. Vaes used the DePaul symptom groupings which we keep as-is.

**Notes:** The DSQ-2 uses a single symptom for fatigue. Also, for the "Overall" chart we used the arithmetic mean instead of geometric mean for the Y axis. All other graphs in this study use geometric means exclusively. Shaded bands represent the 95% confidence interval of the linear models when used.

## Similarities

In terms of fatigue, the two groups overlap completely, as ME/CFS patient clusters are expected to. See [@fig-fatigue], below. While the lines have a similar slope and offset we note the R² value is significantly weaker in the low intensity group (0.54 vs. 0.86).

::: {#fig-fatigue fig-cap="Fatigue vs. PEM" fig-pos="h"}
```{r fatigue, include=TRUE}
#| fig-width: 10
#| fig-height: 5
#| out-width: 100%

a <- geo_plot_vs_pem('fatigue', 'Fatigue')

p <- (a | patchwork::plot_spacer()) + 
  plot_layout(heights = c(1.8, 1.8), guides="collect") &
  theme(legend.position = "bottom") 

p
```
:::

\FloatBarrier

While fatigue shows complete overlap in our groups the next charts ([@fig-symptoms]) show how they stand out. In the first chart (top left) we compare the average of all symptoms to PEM. In this chart one can easily discern two tiers of clusters. One has a higher overall symptom burden at any given PEM level compared to the other and this relationship is where we derive the names for our groups: high and low intensity.

Autonomic, Neuroendocrine and Other also follow a similar pattern: Parallel but lower than the high intensity group.

We note that the limited range of PEM severity in the low intensity group (\~2.2 to 2.9) may have otherwise caused it to remain undetected.

::: {#fig-symptoms fig-cap="Similar Symptom Domains vs. PEM" fig-pos="h"}
```{r all_symptoms, include=TRUE}
#| fig-width: 10
#| fig-height: 7
#| out-width: 100%

a <- geo_plot_vs_pem('all_mean', 'Overall Arithmetic Mean')
b <- geo_plot_vs_pem('autonomic', 'Autonomic')
c <- geo_plot_vs_pem('neuroendocrine', 'Neuroendocrine')
d <- geo_plot_vs_pem('other', 'Other')

p <- (a | b )/ ( c| d) + 
  plot_layout(heights = c(1.8, 1.8), guides="collect") &
  theme(legend.position = "bottom") 

p
```
:::

\FloatBarrier

```{r groups, include=TRUE}

high_intensity <- vcs_tidy %>%
  filter(intensity_group == "high") %>%
  pull(cluster)

high_intensity <- mixedsort(high_intensity)

low_intensity <- vcs_tidy %>%
  filter(intensity_group == "low") %>%
  pull(cluster)

low_intensity <- mixedsort(low_intensity)

```

**Groupings:** From visual inspection of the charts above we group clusters `r high_intensity` as high intensity, `r low_intensity` as low intensity. We'll keep these groupings for all plots that follow. The high and low groups are approximately `r high_pct`% and `r low_pct`% of the total cohort, respectively.

The last chart (Other vs. PEM) shows a markedly lower offset and is perhaps the most visibly obvious difference between the two groups. The two symptoms in 'other' are sensitivity to mold and vibration.

\FloatBarrier

While the groups maintain integrity, the parallelism observed in the charts above does not hold in the next charts and suggests a more complex physiological cause for the differences.

## Increasing Amplification vs. PEM

Pain and neurocognitive domains show that while the low intensity group remains offset, symptom domain amplification is increased. As PEM increases to 3, C7 comes very close to the high intensity line.

::: {#fig-pain fig-cap="Pain and Neurocognitive vs. PEM" fig-pos="h"}
```{r neuro_c_symptoms, include=TRUE}
#| fig-width: 10
#| fig-height: 5
#| out-width: 100%
#| 

b <- geo_plot_vs_pem('neurocognitive', 'Neurocognitive')
c <- geo_plot_vs_pem('pain', 'Pain')

p <- (b | c) + 
  plot_layout(heights = c(1, 1), guides="collect") &
  theme(legend.position = "bottom") 

p
```
:::

\FloatBarrier

The two charts above, while not severe enough to claim this is fibromyalgia with PEM, begin to suggest it.

## Different Correlations to PEM

In all of the previous charts we've shown that both groups maintain a strong but distinct relationship to PEM. By contrast, the immune and sleep domains show little to no correlation with PEM severity in the low intensity group. Notably, despite this lack of correlation, sleep disturbance can be pronounced in the low intensity group.

::: {#fig-distinct fig-cap="Immune and Sleep vs. PEM" fig-pos="h"}
```{r immune_symptoms, include=TRUE}
#| fig-width: 10
#| fig-height: 5
#| out-width: 100%

a <- geo_plot_vs_pem('Immune', 'Immune')
b <- geo_plot_vs_pem('Sleep', 'Sleep')

p <- (a | b ) + 
 plot_layout(heights = c(1.8, 1.8), guides="collect") &
  theme(legend.position = "bottom")   # one shared legend 

p
```
:::

\FloatBarrier

## Summary of Differences

**High Intensity:** Has a consistent amplification pattern: as PEM increases, all other symptom domains rise together.

**Low Intensity:** Presents a more selective profile. Pain, neurocognitive, and neuroendocrine symptoms escalate more rapidly with PEM, while sleep and immune symptoms show little or no correlation. The elevated neurocognitive and pain symptoms, together with variable sleep symptom intensity makes the low-intensity group more suggestive of fibromyalgia than the high-intensity group. Additionally, the low intensity group is notably nestled in the middle of the overall PEM range which could allow it to hide among the other clusters if not actively searched for.

We summarize these differences in the table below.\bigskip

::: {#tbl-t1 tbl-cap="Summary of Group Differences" tbl-pos="h"}
| Feature         | High group  | Low group                     |
|-----------------|-------------|-------------------------------|
| Overall vs. PEM | Higher      | Lower - esp. "other"          |
| Fatigue         | R² - 0.86   | Weaker R² - 0.54              |
| PEM range       | \~1.3 – 3.4 | Narrower \~2.2 – 2.9          |
| Neurocognitive  | Tracks PEM  | Elevated amplification        |
| Pain            | Tracks PEM  | Elevated amplification        |
| Immune          | Tracks PEM  | Flat at \~1                   |
| Sleep           | Tracks PEM  | \~1.4 – 2.5, but uncorrelated |
:::

\bigskip

**Symptom Severity:** In terms of overall symptom range the two groups largely overlap. The high intensity group, by symptom intensity alone, could be considered a superset of the low intensity group. It is the differing relationships to PEM and the selective amplification of certain symptom domains in the low intensity group that set the two groups apart.

# Regression Analysis

In the preceding section we used visual analysis to identify two subgroups of ME/CFS patient clusters defined by their symptom domain profiles relative to PEM severity. Here we focus on quantifying the value of these groups.

## R² by Group

We compare the regression coefficient (R²) of the symptom domains in three levels:

-   Combined (all clusters)
-   High intensity group
-   Low intensity group

We will show that R² is consistently strengthened by removing the low intensity group, and we'll also show that the high intensity group maintains a stronger correlation to PEM across most symptom domains. \FloatBarrier

::: {#tbl-t2 tbl-cap="R² by Domain" fig-pos="h"}
```{r r2_domain, include=TRUE}
input_file <- here::here("data","r2_by_domain_combined_high_low.csv")
if (!file.exists(input_file)) {
  stop(paste("Input file", input_file, "not found. Please run r2_by_domain.R first."))
}

res <- read_csv(input_file) %>%
  rename(Domain = domain) %>%
  mutate(Domain = str_to_title(Domain)) %>%
  arrange(Domain)

# Capitalize first letter in Domain
gt(res) %>% 
  tab_options(latex.tbl.pos = "h")
```
:::

@tbl-t2 shows that for almost every symptom domain, the high intensity group has a higher R² than the combined group, which in turn has a higher R² than the low intensity group. This is consistent with our visual analysis and supports the existence of two distinct subgroups within the Vaes clusters.

In some cases, like neurocognitive, neuroendocrine, and Other the combined R² is significantly weaker than either of the subgroups.

\FloatBarrier

## Leave-one-out Analysis

We discovered our two groups by visual analysis, but we can rediscover the set using leave-one-out analysis. In this analysis we go through each domain and examine what happens when we remove one cluster at a time. The goal is to identify whether removing a cluster improves R² or makes it worse.

We summarize the mean R² differences, in order of greatest improvement, in @tbl-t3. We see that removing any of the low intensity clusters improves R².

::: {#tbl-t3 tbl-cap="Leave-one-out Analysis" fig-pos="h"}
```{r loo_analysis, include=TRUE}
input_file <- here::here("data","loo_delta_r2_by_cluster.csv")
if (!file.exists(input_file)) {
  stop(paste("Input file", input_file, "not found. Please run leave_one_out.R first."))
}

res_loo <- read_csv(input_file) %>%
  mutate(mean_dR2 = round(mean_dR2, 4)) %>%
  select(Cluster = cluster, `Domains Improved` = domains_improved, mean_dR2) %>%
  arrange(desc(mean_dR2)) %>%
  head(6)

res_loo <- left_join(res_loo, vcs_tidy, by = c("Cluster" = "cluster")) %>%
  select(Cluster, Group = intensity_group, `Domains Improved`, mean_dR2) %>%
  rename(`Mean ΔR²` = mean_dR2)


gt(res_loo)
  
```
:::

Of the top 6 clusters only C31 is not part of the low intensity group.

The **R² by Group** and **Leave-one-out Analysis** strongly support the existence of two distinct subgroups within the Vaes clusters.

\FloatBarrier

# Discussion

We have shown that the Vaes clusters can be organized into two subgroups defined by symptom domains relative to PEM, and that these subgroups remain consistent across most symptom domains.

ME/CFS is widely recognized as a heterogeneous condition with complex symptom presentations. Grouping the Vaes clusters by their relationship to PEM simplifies this complexity at the domain and cluster levels, but it only partially reduces heterogeneity at the individual-symptom level and may not translate directly to grouping individual patients. Vaes[@vaes2023] provided cluster-specific summaries of standout symptoms; some of those align with our domain-based charts while others show a different emphasis, underscoring the challenge of reconciling symptom-level observations with domain-level analyses.

The wide net cast by Vaes in terms of diagnostic criteria may have helped to reveal these two subgroups. The high intensity group aligns more closely with classic ME/CFS presentations, while the low intensity group, with its fibromyalgia-like profile, suggests a different or overlapping pathophysiology. This is consistent with prior observations that fibromyalgia and ME/CFS often co-occur and may share underlying mechanisms.

Although these patterns may guide future phenotyping, several cautions are warranted. This is a secondary analysis of patient clusters defined by symptom domains with small subgroup sizes (8 and 5 clusters). The original clustering methods of Vaes et al. may have obscured or exaggerated some relationships we show here. Moreover, visual inspection of the plots may suggest directional trends where none truly exist.

Despite these limitations, we believe at least two further steps should be taken. Using the original patient scores could validate, refine, or repudiate these subgroups and possibly produce a short list of differentiating symptoms. If this proves useful then examining biological markers across these subgroups could help to reveal underlying pathophysiological differences.

# Conclusion

Our secondary analysis shows that the many heterogeneous Vaes clusters can be organized into two broader structures defined by overall symptom intensity relative to PEM severity. These two groups remain coherent across symptom domains and display distinct, largely linear relationships with PEM. Although exploratory and limited to cluster-level data, these findings offer a reproducible framework that may help clarify apparent heterogeneity in ME/CFS.

\clearpage

# Appendices

\FloatBarrier

## Appendix A: Cluster Summary Data

We use the Vaes cluster spreadsheet[@vaes2023_excel] exclusively as our data source. We use R for significant cleaning and transformation from Excel to CSV. After removing everything but the mean severity of the symptoms in the 13 clusters we:

-   Group each cluster by symptom domain and calculate geometric means for each symptom domain within each cluster.
-   Rotate the table
-   Add a new column, "all_mean" which is the arithmetic mean of all symptoms within each cluster.
-   Save this file as cluster_grouped_tidy.csv

This file is what we then used for our analysis, and the plots. We present the final data used below. Values were rounded and abbreviations used for formatting. See the [Code Availability](#sec-code) section for links to the code used to generate this file.

::: {tbl-cap="Cluster Summary Data with Geometric Means by Symptom Domain" tbl-pos="h"}
```{r cluster_summary, include=TRUE}


rounded_vcs_tidy <- vcs_tidy %>%
  select(-intensity_group) %>%
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  select(cluster, all_mean, PEM, fatigue, Auto = autonomic, Immune, NC = neurocognitive, NE = neuroendocrine, pain, other)


gt(rounded_vcs_tidy) %>% 
  tab_options(latex.tbl.pos = "h")
```
:::

\FloatBarrier

# References {.unnumbered}

::: {#refs}
:::

{{< pagebreak >}}

{{< pagebreak >}}

# Acknowledgements {.unnumbered}

This paper could not exist without the foundational work of Dr. Anouk W. Vaes and her colleagues at CIRO, whose clustering study[@vaes2023] and publicly available cluster summary data[@vaes2023_excel] provided the basis for our analysis. We are deeply grateful for their contribution to the field.

Dr. Vaes had no role in the writing of this paper, and all errors or misinterpretations are the responsibility of the author.

# Author Contributions {.unnumbered}

Erik K. Squires conceived the study, performed the analysis, and wrote the manuscript. This work presents an original investigative method and resulting framework which were both developed and first reported by the author in this preprint.

# Competing Interests {.unnumbered}

The author declares no competing interests.

# Funding {.unnumbered}

This work received no external funding.

# Ethics Statement {.unnumbered}

This study reanalyzed publicly available reports and published symptom cluster data (Vaes 2023). No new patient data were collected.
